[Unit]
Description=Gstreamer RTP Camera Sink
After=network.online.target
Wants=network.online.target

[Service]
Type=simple
User={{ gstreamer_user }}
ExecStart=gst-launch-1.0 libcamerasrc ! \
    capsfilter caps=video/x-raw,width={{ gstreamer_video_w }},height={{ gstreamer_video_h }},format=NV12 ! \
    v4l2convert ! \
    v4l2h264enc extra-controls="controls,repeat_sequence_header=1" ! \
    'video/x-h264,level=(string)4' ! \
    h264parse ! \
    rtph264pay ! \
    udpsink host={{ gstreamer_rtp_host }} port={{ gstreamer_rtp_port }}
[Install]
WantedBy=multi-user.target