- name: Create fake license.txt
  become: true
  ansible.builtin.file:
    path: /tmp/license.txt
    state: touch
    mode: 0644

- name: Create fake license archive
  become: true
  community.general.archive:
    path: /tmp/license.txt
    dest: '{{ printnanny_license_zip }}'
    mode: 0644
    format: zip


# ignore failing printnanny verify command for now
- name: License install tasks
  include_role:
    name: bitsyai.rpi.printnanny
    tasks_from: activate_license

- name: Stat extracted license.txt
  ansible.builtin.stat:
    path: '{{ printnanny_data_dir }}/license.txt'
  register: license

- name: Assert license.txt in expected path
  assert:
    that:
      - license.stat.exists
